import{a as n,t as I,i as u,F as z,d as P,b as S,e as C,y as l,f as M,T as i,B as q,w as O,s as F,x as w,k as K,P as E,h as U,M as A,r as W,W as G}from"./index-CQ3-BSEL.js";import{u as X}from"./useRowTarget-DdIL0a9L.js";import{g as k}from"./error-helpers-D9jUdhyT.js";import{P as H}from"./Panel-BJ5ATSyq.js";import{C as J,A as Q}from"./ActionDropdown-DU8N8G-B.js";import{I as V,T as Y,E as Z,B as ee}from"./Tooltip-C4WAYcWb.js";import{I as D}from"./InfoRow-j4GZ1DzO.js";import{D as te}from"./ContentLocaleSelect-Cb-MBOKh.js";import{a as y,C as R}from"./Confirmation-BG2UDkdk.js";import{S as ne}from"./Standard-DQ0Jv3GR.js";import"./ISASYZ5H-BKhR2em3.js";import"./ErrorMessage-BUQl5hDc.js";var re=I('<div class="flex items-baseline justify-between mx-4 md:mx-6 py-4 md:py-6 border-b border-border">'),ae=I('<div class="px-4 md:px-6 pb-4 md:pb-6">'),ie=I('<div class="fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto">');const se=e=>n(y.Root,{get open(){return e.state.open},onOpenChange:()=>e.state.setOpen(!e.state.open),get children(){return n(y.Portal,{get children(){return[n(y.Overlay,{class:"fixed inset-0 z-40 bg-black/80 animate-animate-overlay-hide cursor-pointer duration-200 transition-colors data-expanded:animate-animate-overlay-show"}),(()=>{var t=ie();return u(t,n(y.Content,{class:"z-50 max-w-2xl w-full bg-background-base rounded-xl border-border border m-auto animate-animate-modal-hide data-expanded:animate-animate-modal-show",get children(){return[(()=>{var r=re();return u(r,n(y.Title,{get children(){return e.copy.title}}),null),u(r,n(y.CloseButton,{class:"text-body hover:text-title ring-error-base focus:ring-1 focus:outline-hidden h-8 w-8 min-w-[32px] rounded-full flex justify-center items-center duration-200 transition-colors",get children(){return n(z,{class:"fill-current"})}}),null),r})(),(()=>{var r=ae();return u(r,n(P,{get when(){return e.copy.description},get children(){return n(y.Description,{get children(){return e.copy.description}})}}),null),u(r,n(P,{get when(){return e.children},get children(){return e.children}}),null),r})()]}})),t})()]}})}}),oe=e=>{const[t,r]=S(""),[c,s]=S(""),[f,a]=S(!0),o=C.clientIntegrations.useGetSingle({queryParams:{location:{id:e.id}},key:()=>e.state.open,enabled:()=>e.state.open&&d()!=="create"}),p=C.clientIntegrations.useCreateSingle({onSuccess:g=>{var _,b;e.state.setOpen(!1),(b=(_=e.callbacks)==null?void 0:_.onCreateSuccess)==null||b.call(_,g.data.apiKey)}}),h=C.clientIntegrations.useUpdateSingle({onSuccess:()=>{e.state.setOpen(!1)}});M(()=>{var g,_,b;o.isSuccess&&(r(((g=o.data)==null?void 0:g.data.name)||""),s(((_=o.data)==null?void 0:_.data.description)||""),a(((b=o.data)==null?void 0:b.data.enabled)||!1))});const d=l(()=>e.id===void 0||e.id()===void 0?"create":"update"),m=l(()=>d()==="create"?!1:o.isLoading),v=l(()=>d()==="create"?!1:o.isError),T=l(()=>d()==="create"?i()("create_client_integration_panel_title"):i()("update_client_integration_panel_title")),L=l(()=>d()==="create"?i()("create_client_integration_panel_description"):i()("update_client_integration_panel_description")),B=l(()=>d()==="create"?i()("create"):i()("update")),$=l(()=>{var g,_,b;return q.updateData({name:(g=o.data)==null?void 0:g.data.name,description:(_=o.data)==null?void 0:_.data.description,enabled:(b=o.data)==null?void 0:b.data.enabled},{name:t(),description:c(),enabled:f()})}),N=l(()=>d()==="create"?!1:!$().changed),j=l(()=>p.action.isPending||h.action.isPending),x=l(()=>d()==="create"?p.errors():h.errors());return n(H,{get state(){return{open:e.state.open,setOpen:e.state.setOpen}},get fetchState(){return{isLoading:m(),isError:v()}},get mutateState(){return{isLoading:j(),isDisabled:N(),errors:x()}},callbacks:{onSubmit:()=>{var g;d()==="create"?p.action.mutate({name:t(),description:c(),enabled:f()}):h.action.mutate({id:(g=e.id)==null?void 0:g.call(e),body:$().data})},reset:()=>{r(""),s(""),a(!0),p.reset(),h.reset()}},get copy(){return{title:T(),description:L(),submit:B()}},options:{padding:"24"},children:()=>[n(V,{id:"name",name:"name",type:"text",get value(){return t()},onChange:r,get copy(){return{label:i()("name")}},required:!0,get errors(){return k("name",x)},theme:"full"}),n(Y,{id:"description",name:"description",get value(){return c()},onChange:s,get copy(){return{label:i()("description")}},rows:3,get errors(){return k("description",x)},theme:"full"}),n(J,{id:"enabled",name:"enabled",get value(){return f()},onChange:g=>a(g),get copy(){return{label:i()("enabled")}},get errors(){return k("enabled",x)},theme:"full"})]})},le=e=>{const t=C.clientIntegrations.useDeleteSingle({onSuccess:()=>{var r;e.state.setOpen(!1),(r=e.callbacks)!=null&&r.onSuccess&&e.callbacks.onSuccess()}});return n(R,{get state(){return{open:e.state.open,setOpen:e.state.setOpen,isLoading:t.action.isPending,isError:t.action.isError}},get copy(){var r;return{title:i()("delete_client_integration_modal_title"),description:i()("delete_client_integration_modal_description"),error:(r=t.errors())==null?void 0:r.message}},callbacks:{onConfirm:()=>{const r=typeof e.id=="function"?e.id():e.id;if(!r)return console.error("No id provided");t.action.mutate({id:r})},onCancel:()=>{e.state.setOpen(!1),t.reset()}}})};var ce=I('<input class="focus:outline-hidden px-2.5 text-sm text-title font-medium h-14 rounded-md bg-input-base w-full"type=text disabled>'),de=I("<p class=mt-4>");const ge=e=>n(se,{get state(){return{open:e.state.open,setOpen:e.state.setOpen}},get copy(){return{title:i()("copy_api_key_modal_title")}},get children(){return[(()=>{var t=ce();return O(()=>F(t,"aria-label",i()("copy_api_key_modal_description"))),O(()=>t.value=e.apiKey||""),t})(),(()=>{var t=de();return u(t,()=>i()("copy_api_key_modal_description")),t})()]}}),ue=e=>{const t=C.clientIntegrations.useRegenerateAPIKey({onSuccess:r=>{var c;e.state.setOpen(!1),(c=e.callbacks)!=null&&c.onSuccess&&e.callbacks.onSuccess(r.data.apiKey)}});return n(R,{theme:"primary",get state(){return{open:e.state.open,setOpen:e.state.setOpen,isLoading:t.action.isPending,isError:t.action.isError}},get copy(){var r;return{title:i()("regenerate_api_key_modal_title"),description:i()("regenerate_api_key_modal_description"),error:(r=t.errors())==null?void 0:r.message}},callbacks:{onConfirm:()=>{const r=typeof e.id=="function"?e.id():e.id;if(!r)return console.error("No id provided");t.action.mutate({id:r})},onCancel:()=>{e.state.setOpen(!1),t.reset()}}})};var me=I('<p class="text-sm mb-0 leading-none">'),_e=I('<div class="bg-card-base p-4 rounded-md border border-border mb-2.5 last:mb-0 flex items-center justify-between"><div class="flex items-start"><span></span><div><h3> (<!>)');const pe=e=>{const t=l(()=>w.get.hasPermission(["update_client_integration"]).all),r=l(()=>w.get.hasPermission(["delete_client_integration"]).all),c=l(()=>w.get.hasPermission(["regenerate_client_integration"]).all);return(()=>{var s=_e(),f=s.firstChild,a=f.firstChild,o=a.nextSibling,p=o.firstChild,h=p.firstChild,d=h.nextSibling;return d.nextSibling,u(p,()=>e.clientIntegration.name,h),u(p,()=>e.clientIntegration.key,d),u(o,n(P,{get when(){return e.clientIntegration.description},get children(){var m=me();return u(m,()=>e.clientIntegration.description),m}}),null),u(s,n(Q,{get actions(){return[{type:"button",label:i()("update"),onClick:()=>{e.rowTarget.setTargetId(e.clientIntegration.id),e.rowTarget.setTrigger("update",!0)},permission:t()},{type:"button",label:i()("delete"),onClick:()=>{e.rowTarget.setTargetId(e.clientIntegration.id),e.rowTarget.setTrigger("delete",!0)},permission:r()},{type:"button",label:i()("regenerate_api_key"),onClick:()=>{e.rowTarget.setTargetId(e.clientIntegration.id),e.rowTarget.setTrigger("regenerateAPIKey",!0)},permission:c()}]}}),null),O(m=>{var v=K("w-4 h-4 rounded-full block mr-2.5",{"bg-primary-base":e.clientIntegration.enabled,"bg-error-base":!e.clientIntegration.enabled}),T=K("text-base leading-none",{"mb-2":e.clientIntegration.description});return v!==m.e&&E(a,m.e=v),T!==m.t&&E(p,m.t=T),m},{e:void 0,t:void 0}),s})()},Pe=e=>{const t=X({triggers:{delete:!1,regenerateAPIKey:!1,apiKey:!1,update:!1}}),[r,c]=S(),s=C.clientIntegrations.useGetAll({queryParams:{}}),f=l(()=>w.get.hasPermission(["create_client_integration"]).all);return n(G,{get slots(){return{header:n(ne,{get copy(){return{title:i()("system_client_integrations_route_title"),description:i()("system_client_integrations_route_description")}},get actions(){return{create:[{open:t.getTriggers().update,setOpen:a=>{t.setTargetId(void 0),t.setTrigger("update",a)},permission:f(),label:i()("create_integration")}]}}})}},get children(){return[n(te,{get state(){return{isError:s.isError,isSuccess:s.isSuccess,isLoading:s.isLoading}},options:{padding:"24"},get children(){return n(D.Root,{get title(){return i()("manage_integrations")},get description(){return i()("manage_integrations_description")},get children(){return n(U,{get children(){return[n(A,{get when(){var a,o;return((a=s.data)==null?void 0:a.data)&&((o=s.data)==null?void 0:o.data.length)>0},get children(){return n(W,{get each(){var a;return(a=s.data)==null?void 0:a.data},children:a=>n(pe,{clientIntegration:a,rowTarget:t})})}}),n(A,{get when(){var a;return((a=s.data)==null?void 0:a.data.length)===0},get children(){return n(D.Content,{get children(){return n(Z,{get content(){return{title:i()("no_client_integrations_found_title"),description:i()("no_client_integrations_found_descriptions")}},options:{contentMaxWidth:"md"},get children(){return n(ee,{type:"submit",theme:"primary",size:"medium",onClick:()=>{t.setTargetId(void 0),t.setTrigger("update",!0)},get children(){return i()("create_integration")}})}})}})}})]}})}})}}),n(le,{get id(){return t.getTargetId},get state(){return{open:t.getTriggers().delete,setOpen:a=>{t.setTrigger("delete",a)}}}}),n(oe,{get id(){return t.getTargetId},get state(){return{open:t.getTriggers().update,setOpen:a=>{t.setTrigger("update",a)}}},callbacks:{onCreateSuccess:a=>{c(a),t.setTrigger("apiKey",!0)}}}),n(ge,{get apiKey(){return r()},get state(){return{open:t.getTriggers().apiKey,setOpen:a=>{t.setTrigger("apiKey",a)}}},callbacks:{onClose:()=>{c(void 0)}}}),n(ue,{get id(){return t.getTargetId},get state(){return{open:t.getTriggers().regenerateAPIKey,setOpen:a=>{t.setTrigger("regenerateAPIKey",a)}}},callbacks:{onSuccess:a=>{c(a),t.setTrigger("apiKey",!0)}}})]}})};export{Pe as default};
