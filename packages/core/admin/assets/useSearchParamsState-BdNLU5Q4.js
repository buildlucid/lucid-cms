import{b as f,Q as U}from"./index-CQ3-BSEL.js";import{D as v,a as M}from"./useSearchParamsLocation-Sjso8rcp.js";const V=(A,p)=>{const[b,j]=f(A),[E,O]=f(""),[g,u]=f(new Map),[S,F]=f(new Map),[P,k]=f({page:M,perPage:v}),[h,w]=f(!1),[D,l]=f(!1),Q=e=>{if(e!==void 0)return typeof e=="boolean"?e?"1":"0":Array.isArray(e)?e.length?e.join(","):void 0:e.toString()},T=e=>{const t=g(),r=S(),s=P(),o=new Map(t),n=new Map(r),i={...s};if(e.filters)for(const[a,c]of Object.entries(e.filters))c===""?o.set(a,void 0):o.set(a,c);if(e.sorts)if(p!=null&&p.singleSort){const a=Object.keys(e.sorts)[0],c=e.sorts[a];n.forEach(($,L)=>{n.set(L,void 0)}),n.set(a,c)}else for(const[a,c]of Object.entries(e.sorts))n.set(a,c);e.pagination&&(e.pagination.page?i.page=e.pagination.page:i.page=M,e.pagination.perPage?i.perPage=e.pagination.perPage:i.perPage=v),u(o),F(n),k(i),d(),y(),l(!0)},_=()=>{const e=b();if(e!=null&&e.filters){const t=new Map;for(const[r,s]of Object.entries(e.filters))s.value===""?t.set(r,void 0):s.type==="array"?t.set(r,[s.value]):t.set(r,s.value);u(t)}if(e!=null&&e.sorts){const t=new Map;for(const[r,s]of Object.entries(e.sorts))t.set(r,s);F(t)}e!=null&&e.pagination&&k({page:e.pagination.page||M,perPage:e.pagination.perPage||v}),d(),y(),l(!0)},d=()=>{const e=new URLSearchParams,t=g(),r=S(),s=P();for(const[n,i]of t){const a=Q(i);a!==void 0&&e.set(`filter[${n}]`,a)}let o="";for(const[n,i]of r)i==="asc"?o+=`${n},`:i==="desc"&&(o+=`-${n},`);o&&(o=o.slice(0,-1),e.set("sort",o)),s.page&&e.set("page",s.page.toString()),s.perPage&&e.set("perPage",s.perPage.toString()),O(e.toString())},y=()=>{for(const[e,t]of g()){if(t!==void 0){w(!0);break}w(!1)}},H=()=>{const e=g(),t=new Map;for(const[r]of e)t.set(r,void 0);u(t),d(),y(),l(!0)};return U(()=>{_()}),{getFilters:g,getSorts:S,getPagination:P,getQueryString:E,setParams:T,hasFiltersApplied:h,resetFilters:H,getSettled:D,setFilterSchema:e=>{j(t=>({...t,filters:e})),setTimeout(()=>{l(!0)},1)}}};export{V as u};
